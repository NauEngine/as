Реализация поддержки нового скриптового языка
=============================================

В этом документе описан текущий подход к реализации поддержки скриптовых языков,
однако в процессе разработки стало понятно что можно сделать проще и лучше.
Поэтому рекомендуется сначала ознакомиться с документов про [дальнейшее развитие
проекта](./docs/whats_next.md), выполнить предлагаемый там рефакторинг, а после
этого переписать этот документ :)

Для поддержки скриптового языка, необходимо реализовать три интерфейса:
- `ILanguage` - базовый интерфейс. Собственно он регистрирустеся в скриптовой
системе. Создается один экземпляр на все приложение
- `ILanguageScript` - интерфейс для загрузки модуля. Создается по экземпляру
на каждый модуль данного языка
- `ILanguageRuntime` - интерфейс для храненения runtime для поддержки языка
(различные сборщики мусора, какая-то другая общая логика). Не является
обязательным

`ILanguage`
-----------

### `init`
Инициализация какой-то общей логики поддержки компиляции скриптового языка. Все
что связано с материализацией модулей данного языка, должно быть реализовано в
runtime объекте. Для AOT-компиляции никаких экземпляров `ILanguage` или
`ILanguageScript` не существует

### `newScript`
Создание нового экземпляра `ILanguageScript` с логикой загрузки (компиляции и
метериализации) модуля данного языка

`ILanguageScript`
-----------------
Данный интерфейс отвечает за загрузку модуля, его компиляцию (для
AOT-компиляции и JIT-компиляции), а также за материализацию (только JIT).

Во время компиляции последовательно вызываются функции: `load`, `createModule` и
`buildModule`

### `load`
Загрузить код скрипта из файла. В зависимости от процедуры компиляции языка, в
данной функции может происходить все - от простой загрузки файла в строку (для
последующей компиляции), до генерации LLVM модуля

### `createModule`
Создать экземпляр LLVM модуля для данного скриптового модуля. В большинстве
случаев там будет достаточно:
```cpp
return std::make_unique<llvm::Module>("is_module", context);
```

### `buildModule`
Скомпилировать модуль и вернуть LLVM init-функцию для даннного модуля

### `getInterface`
Получить интерфейс, реализованный в указанном файле

### `materialize`
Материализовать данный модуль. Используется только в режиме JIT-компиляции
